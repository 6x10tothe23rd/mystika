⎕IO ⎕ML←0 1

SHA512←{512⍴0}
SHA512∆P←{(⊢⍴⍨16 64,⍨1024÷⍨≢)⍵,1,(0⍴⍨896-1+≢⍵),(128⍴2)⊤≢⍵}
SHA512∆H0←↑{⊃⌽{(1|d)((⊃⌽⍵),⌊d←2×⊃⍵)}⍣64-∘⌊⍨⍵⍬*.5⊣⎕FR←1287}¨(2=+⌿0=X∘.|X)/X←⍳20
SHA512∆S←{((-⍺)↑⍵),(-⍺)↓⍵}
SHA512∆R←{(⍺⍴0),(-⍺)↓⍵}
SHA512∆Sg0←{(28SHA512∆S⍵)≠(34SHA512∆S⍵)≠39SHA512∆S⍵}
SHA512∆Sg1←{(14SHA512∆S⍵)≠(18SHA512∆S⍵)≠41SHA512∆S⍵}
SHA512∆sg0←{(1SHA512∆S⍵)≠(8SHA512∆S⍵)≠7SHA512∆R⍵}
SHA512∆sg1←{(19SHA512∆S⍵)≠(61SHA512∆S⍵)≠6SHA512∆R⍵}