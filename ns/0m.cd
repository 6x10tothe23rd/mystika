⎕IO ⎕ML←0 1

SHA512←{512⍴0}
SHA512∆P←{(⊢⍴⍨16 64,⍨1024÷⍨≢)⍵,1,(0⍴⍨896-1+≢⍵),(128⍴2)⊤≢⍵}
SHA512∆H0←↑{⊃⌽{(1|d)((⊃⌽⍵),⌊d←2×⊃⍵)}⍣64-∘⌊⍨⍵⍬*.5⊣⎕FR←1287}¨(2=+⌿0=X∘.|X)/X←⍳20
SHA512∆R←{(⍺⍴0),(-⍺)↓⍵}
SHA512∆S0←{(¯28⌽⍵)≠(¯34⌽⍵)≠¯39⌽⍵}
SHA512∆S1←{(¯14⌽⍵)≠(¯18⌽⍵)≠¯41⌽⍵}
SHA512∆s0←{(¯1⌽⍵)≠(¯8⌽⍵)≠7SHA512∆R⍵}
SHA512∆s1←{(¯19⌽⍵)≠(¯61⌽⍵)≠6SHA512∆R⍵}
